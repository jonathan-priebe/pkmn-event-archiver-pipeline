services:
  mg-pipeline:
    build: .
    environment:
      # Source (ZIP URL) - can also point to local file (file:///...)
      ARCHIVE_URL: "https://projectpokemon.org/home/applications/core/interface/file/attachment.php?id=22884"
      # Optional: explicit game mapping override per folder name/regex (see config/mapping.yml)
      ENABLE_MAPPING_OVERRIDE: "true"
      # Output directory (mounted as volume)
      OUTPUT_DIR: "/work/DLC"
      # Accepted file extensions
      INPUT_EXTS: ".pcd,.pgt,.pgf,.wc4,.wc5"
      # Parallelization
      WORKERS: "4"
    volumes:
      - mg-dlc:/work/DLC
      - ./config:/work/config
    command: [ "bash", "/work/run.sh" ]
    
  mg-web:
    build: ./web
    environment:
      OUTPUT_DIR: "/work/DLC"
    volumes:
      - mg-dlc:/work/DLC:ro
    ports:
      - "8080:8080"

volumes:
  mg-dlc:
